<!DOCTYPE html>
<html>

    <head>
        <% include ./partials/head %>
            <script type="text/javascript" src="../public/facebook.js"></script>
    </head>

    <body>
        <% include ./partials/nav %>

            <div class="container contact contact-index">
                <!-- google login button -->
                <div class="g-signin2" data-onsuccess="onSignIn"></div>
                <!-- facebook login button -->
                <fb:login-button scope="public_profile,email" onlogin="checkLoginState();"></fb:login-button>
            </div>

            <form class="form-horizontal" action="/signin" method="post">
                <div class="form-group">
                    <label class="control-label col-sm-2" for="email">EMail</label>
                    <div class="col-sm-10">
                        <input type="email" class="form-control" name="email" placeholder="email">
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button type="submit" class="btn btn-default">Submit</button>
                    </div>
                </div>
            </form>



            <script>
                function post(path, params, method) {
                    method = method || "post"; // Set method to post by default if not specified.

                    // The rest of this code assumes you are not using a library.
                    // It can be made less wordy if you use one.
                    var form = document.createElement("form");
                    form.setAttribute("method", method);
                    form.setAttribute("action", path);

                    for (var key in params) {
                        if (params.hasOwnProperty(key)) {
                            var hiddenField = document.createElement("input");
                            hiddenField.setAttribute("type", "hidden");
                            hiddenField.setAttribute("name", key);
                            hiddenField.setAttribute("value", params[key]);

                            form.appendChild(hiddenField);
                        }
                    }

                    document.body.appendChild(form);
                    form.submit();
                }

                function onSignIn(googleUser) {
                    var profile = googleUser.getBasicProfile();
                    console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
                    console.log('Name: ' + profile.getName());
                    console.log('Image URL: ' + profile.getImageUrl());
                    console.log('Email: ' + profile.getEmail());

                    document.getElementById("google e-mail").innerHTML = profile.getEmail();
                    post('/signin', {
                        email: profile.getEmail()
                    });
                }

            </script>
    </body>

</html>
